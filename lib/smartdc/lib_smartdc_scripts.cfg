#!/usr/bin/env bash

#
# Copyright (c) 2013 Joyent Inc., All rights reserved.
#
# Common variables used by scripts in /lib/smartdc

# Global debug level for all scripts in /lib/smartdc
DEBUG=0

# location of binaries that functions use
LOGGER=/usr/bin/logger

MDATA_SERIAL_PORT='/dev/cuau1'
MDATA_GET_BIN='/lib/smartdc/mdata-get'

# location of common files
USER_SCRIPT_FILE='/var/tmp/user-script'
USER_SCRIPT_LOCKFILE='/var/tmp/user-script.lock'

# Common functions used by scripts /lib/smartdc

lib_smartdc_log() {
  $LOGGER "(info) - $0 - $@"
}

lib_smartdc_fatal() {
  echo " "
  printf "(fatal) %s\n" "$@"
  echo " "
  echo " "
  $LOGGER "(fatal) - $0 - $@"
  exit 1
}

lib_smartdc_info() {
  printf "(info) %s\n" "$@"
  $LOGGER "(info) - $0 - $@"
}

lib_smartdc_debug() {
  if [[ $DEBUG -gt 0 ]]; then
    printf "(debug) %s\n" "$@"
    $LOGGER "(debug) - $0 - $@"
  fi
}

# start of main

export -f lib_smartdc_fatal
export -f lib_smartdc_info
export -f lib_smartdc_debug
